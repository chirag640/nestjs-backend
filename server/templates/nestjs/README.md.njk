# {{ projectName }}

{{ description }}

## ğŸ“‹ Description

This project was generated using [FoundationWizard](https://github.com/yourusername/foundation-wizard), an automated NestJS project generator.

**Author:** {{ author }}  
**License:** {{ license }}

## ğŸš€ Tech Stack

- **Framework:** NestJS 10
- **Language:** TypeScript
- **Database:** {{ databaseType }}
{% if databaseType === 'MongoDB' %}
- **ORM:** Mongoose
{% else %}
- **ORM:** TypeORM
{% endif %}
- **Node Version:** {{ nodeVersion }}
- **Package Manager:** {{ packageManager }}

## ğŸ“¦ Installation

```bash
# Install dependencies
{% if packageManager === 'pnpm' %}
pnpm install
{% elif packageManager === 'yarn' %}
yarn install
{% else %}
npm install
{% endif %}
```

## ğŸ”§ Configuration

1. Copy `.env.example` to `.env`:
```bash
cp .env.example .env
```

2. Update the environment variables in `.env`:
```env
DATABASE_URL={{ connectionString }}
PORT=3000
```

## ğŸƒ Running the app

```bash
# Development
{% if packageManager === 'pnpm' %}
pnpm run start:dev
{% elif packageManager === 'yarn' %}
yarn start:dev
{% else %}
npm run start:dev
{% endif %}

# Production mode
{% if packageManager === 'pnpm' %}
pnpm run start:prod
{% elif packageManager === 'yarn' %}
yarn start:prod
{% else %}
npm run start:prod
{% endif %}
```

## ğŸ³ Docker Support

### Using Docker Compose (Recommended)

```bash
# Start all services (app + database)
docker-compose up -d

# View logs
docker-compose logs -f

# Stop services
docker-compose down
```

### Using Dockerfile only

```bash
# Build image
docker build -t {{ projectName }} .

# Run container
docker run -p 3000:3000 --env-file .env {{ projectName }}
```

## ğŸ§ª Testing

```bash
# Unit tests
{% if packageManager === 'pnpm' %}
pnpm run test
{% elif packageManager === 'yarn' %}
yarn test
{% else %}
npm run test
{% endif %}

# E2E tests
{% if packageManager === 'pnpm' %}
pnpm run test:e2e
{% elif packageManager === 'yarn' %}
yarn test:e2e
{% else %}
npm run test:e2e
{% endif %}

# Test coverage
{% if packageManager === 'pnpm' %}
pnpm run test:cov
{% elif packageManager === 'yarn' %}
yarn test:cov
{% else %}
npm run test:cov
{% endif %}
```

## ğŸ¯ Features

### Basic Features
{% if features.cors %}
- âœ… **CORS:** Cross-Origin Resource Sharing enabled
{% endif %}
{% if features.helmet %}
- âœ… **Helmet:** HTTP security headers protection
{% endif %}
{% if features.compression %}
- âœ… **Compression:** Gzip compression for responses
{% endif %}
{% if features.validation %}
- âœ… **Validation:** Global request validation with class-validator
{% endif %}

### Advanced Features
{% if features.logging %}
- âœ… **Structured Logging:** Pino logger with request tracking and performance metrics
{% endif %}
{% if features.caching %}
- âœ… **Redis Caching:** Distributed caching with cache-manager
{% endif %}
{% if features.swagger %}
- âœ… **API Documentation:** Interactive Swagger/OpenAPI docs at `/api/docs`
{% endif %}
{% if features.health %}
- âœ… **Health Checks:** Terminus health monitoring at `/health`
{% endif %}
{% if features.rateLimit %}
- âœ… **Rate Limiting:** Throttler middleware to prevent abuse
{% endif %}
{% if features.versioning %}
- âœ… **API Versioning:** URI-based versioning support (e.g., `/v1/users`)
{% endif %}

## ğŸ“ API Endpoints

{% if features.swagger %}
### ğŸ“š API Documentation (Swagger)
```
GET /api/docs
```

Interactive API documentation with Swagger UI. All endpoints are documented with request/response schemas{% if auth and auth.enabled %} and JWT authentication{% endif %}.
{% endif %}

{% if features.health %}
### â¤ï¸  Health Check
```
GET /health
```

Returns system health status including:
- Database connectivity
- Memory usage (heap & RSS)
- Disk storage
- Uptime

Response:
```json
{
  "status": "ok",
  "info": {
    "database": { "status": "up" },
    "memory_heap": { "status": "up" },
    "memory_rss": { "status": "up" },
    "disk": { "status": "up" }
  },
  "details": { ... }
}
```
{% endif %}

### Hello World
```
GET /
```

Response:
```
Hello from {{ projectName }}!
```

{% if features.logging %}
## ğŸ“Š Logging

This project uses **Pino** for structured JSON logging with the following features:

- Request/response logging
- Performance tracking (response time)
- Context-aware logging
- Sensitive data redaction (authorization headers, cookies)
- Pretty printing in development mode

Example log output (development):
```
[14:23:45] INFO  (HTTP): Incoming Request: GET /users
[14:23:45] INFO  (HTTP): Request Completed: GET /users (responseTime: 45ms)
```

Production logs are in JSON format for easy parsing and analysis.
{% endif %}

{% if features.caching %}
## ğŸ—„ï¸  Caching

Redis-based distributed caching is configured with:

- **Default TTL:** 5 minutes (300 seconds)
- **Strategy:** Cache-aside pattern
- **Invalidation:** Automatic on TTL expiry

### Usage Example

```typescript
import { CACHE_MANAGER } from '@nestjs/cache-manager';
import { Cache } from 'cache-manager';

@Injectable()
export class YourService {
  constructor(@Inject(CACHE_MANAGER) private cacheManager: Cache) {}

  async getData(key: string) {
    // Try cache first
    const cached = await this.cacheManager.get(key);
    if (cached) return cached;

    // Cache miss - fetch and store
    const data = await this.fetchData();
    await this.cacheManager.set(key, data, 600); // 10 minutes TTL
    return data;
  }
}
```

**Configuration:**
Set `REDIS_URL` in `.env` to use Redis, otherwise falls back to in-memory cache.

```env
REDIS_URL=redis://localhost:6379
```
{% endif %}

{% if features.rateLimit %}
## ğŸš¦ Rate Limiting

Throttler middleware is configured to prevent API abuse:

- **Default:** 10 requests per 60 seconds
- **Scope:** Per IP address
- **Response:** `429 Too Many Requests` when limit exceeded

### Configuration

Adjust rate limits in `.env`:

```env
THROTTLE_TTL=60000      # Time window (ms)
THROTTLE_LIMIT=10       # Max requests per window
```

### Custom Rate Limits

Override limits per controller/route:

```typescript
import { Throttle } from '@nestjs/throttler';

@Controller('api')
export class ApiController {
  @Throttle({ default: { limit: 3, ttl: 60000 } })  // 3 requests per minute
  @Get('expensive-operation')
  expensiveOperation() {
    // ...
  }
}
```
{% endif %}

{% if features.versioning %}
## ğŸ”„ API Versioning

URI-based API versioning is enabled. Add versions to your controllers:

```typescript
import { Controller, Get, Version } from '@nestjs/common';

@Controller('users')
export class UsersController {
  @Version('1')
  @Get()
  findAllV1() {
    return { version: 'v1', users: [] };
  }

  @Version('2')
  @Get()
  findAllV2() {
    return { version: 'v2', users: [], meta: { total: 0 } };
  }
}
```

Access endpoints:
- `GET /v1/users` - Version 1
- `GET /v2/users` - Version 2
{% endif %}

{% if oauth and oauth.enabled %}
## ğŸ” OAuth2 Authentication

This project supports OAuth2 social login with the following providers:
{% for provider in oauth.providers %}
- âœ… **{{ provider.name | capitalize }}**
{% endfor %}

### Setup Instructions

{% for provider in oauth.providers %}
{% if provider.name == 'google' %}
#### Google OAuth Setup

1. **Create OAuth Credentials:**
   - Go to [Google Cloud Console](https://console.cloud.google.com/apis/credentials)
   - Create a new project or select existing one
   - Navigate to "Credentials" â†’ "Create Credentials" â†’ "OAuth Client ID"
   - Choose "Web application" as application type
   - Add authorized redirect URI: `{{ provider.callbackURL }}`

2. **Configure Environment Variables:**
   ```env
   GOOGLE_CLIENT_ID={{ provider.clientId }}
   GOOGLE_CLIENT_SECRET={{ provider.clientSecret }}
   GOOGLE_CALLBACK_URL={{ provider.callbackURL }}
   FRONTEND_URL=http://localhost:3000
   ```

3. **OAuth Flow:**
   - Initiate login: `GET /auth/oauth/google`
   - User authorizes on Google
   - Callback: `GET /auth/oauth/google/callback`
   - Returns JWT access token and redirect to frontend

{% elif provider.name == 'github' %}
#### GitHub OAuth Setup

1. **Create OAuth App:**
   - Go to [GitHub Developer Settings](https://github.com/settings/developers)
   - Click "New OAuth App"
   - Fill in application details:
     - Application name: Your app name
     - Homepage URL: `http://localhost:3000`
     - Authorization callback URL: `{{ provider.callbackURL }}`
   - Click "Register application"
   - Copy Client ID and generate Client Secret

2. **Configure Environment Variables:**
   ```env
   GITHUB_CLIENT_ID={{ provider.clientId }}
   GITHUB_CLIENT_SECRET={{ provider.clientSecret }}
   GITHUB_CALLBACK_URL={{ provider.callbackURL }}
   FRONTEND_URL=http://localhost:3000
   ```

3. **OAuth Flow:**
   - Initiate login: `GET /auth/oauth/github`
   - User authorizes on GitHub
   - Callback: `GET /auth/oauth/github/callback`
   - Returns JWT access token and redirect to frontend

{% endif %}
{% endfor %}

### OAuth API Endpoints

{% for provider in oauth.providers %}
**{{ provider.name | capitalize }} OAuth:**
```
GET /auth/oauth/{{ provider.name }}
```
Initiates the OAuth flow. Redirects user to {{ provider.name | capitalize }} consent screen.

```
GET /auth/oauth/{{ provider.name }}/callback
```
Callback endpoint that handles the OAuth response. On success:
- Creates or finds user by OAuth ID
- Generates JWT access + refresh tokens
- Redirects to `FRONTEND_URL/?token=<access_token>`

{% endfor %}

### Frontend Integration Example

```typescript
// Initiate OAuth login
const handleGoogleLogin = () => {
  window.location.href = 'http://localhost:3000/auth/oauth/google';
};

// Handle callback (in your router)
const OAuthCallback = () => {
  const params = new URLSearchParams(window.location.search);
  const token = params.get('token');
  
  if (token) {
    // Store token
    localStorage.setItem('access_token', token);
    
    // Redirect to dashboard
    navigate('/dashboard');
  }
};
```

### OAuth User Model

Users authenticated via OAuth have the following additional fields:
- `oauthProvider`: Provider name (`'google'` or `'github'`)
- `oauthId`: Unique user ID from the OAuth provider
- `password`: Empty string (OAuth users don't need passwords)

### Security Notes

- OAuth users are automatically assigned the `'User'` role
- JWT tokens are issued after successful OAuth authentication
- Refresh token rotation is supported if JWT blacklist is enabled
- OAuth credentials are validated at application startup

{% endif %}

## ğŸ“ Project Structure

```
{{ projectName }}/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.controller.ts
â”‚   â”œâ”€â”€ app.module.ts
â”‚   â”œâ”€â”€ app.service.ts
â”‚   â””â”€â”€ main.ts
â”œâ”€â”€ test/
â”œâ”€â”€ .env.example
â”œâ”€â”€ .eslintrc.js
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .prettierrc
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ nest-cli.json
â”œâ”€â”€ package.json
â”œâ”€â”€ README.md
â””â”€â”€ tsconfig.json
```

## ğŸ¤ Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## ğŸ“„ License

This project is licensed under the {{ license }} License.

---

Generated with â¤ï¸ by [FoundationWizard](https://github.com/yourusername/foundation-wizard)
