{
  "projectSetup": {
    "projectName": "medical-records-encrypted",
    "description": "Medical records system with field-level encryption (supports LOCAL and AWS KMS strategies), S3 file uploads, queues, and complete security features",
    "author": "Your Name",
    "license": "MIT",
    "nodeVersion": "20",
    "packageManager": "npm"
  },
  "databaseConfig": {
    "databaseType": "MongoDB",
    "provider": "Atlas",
    "connectionString": "mongodb+srv://user:password@cluster.mongodb.net/medicalrecords",
    "autoMigration": "push"
  },
  "modelDefinition": {
    "models": [
      {
        "name": "Worker",
        "timestamps": true,
        "fields": [
          {
            "name": "workerId",
            "type": "string",
            "required": true,
            "unique": true,
            "indexed": true
          },
          { "name": "fullName", "type": "string", "required": true },
          {
            "name": "email",
            "type": "string",
            "required": true,
            "unique": true
          },
          { "name": "phoneNumber", "type": "string", "indexed": true },
          { "name": "dateOfBirth", "type": "date" },
          { "name": "bloodGroup", "type": "string" },
          { "name": "profilePhotoUrl", "type": "string" },
          {
            "name": "healthHistory",
            "type": "string",
            "comment": "ENCRYPTED FIELD - Medical history and diagnoses"
          },
          {
            "name": "allergies",
            "type": "string[]",
            "comment": "ENCRYPTED FIELD - List of allergies"
          },
          {
            "name": "currentMedication",
            "type": "string",
            "comment": "ENCRYPTED FIELD - Active prescriptions"
          },
          {
            "name": "socialSecurityNumber",
            "type": "string",
            "comment": "ENCRYPTED FIELD - SSN or national ID"
          },
          {
            "name": "emergencyContactName",
            "type": "string"
          },
          {
            "name": "emergencyContactPhone",
            "type": "string"
          }
        ]
      },
      {
        "name": "Visit",
        "timestamps": true,
        "fields": [
          { "name": "visitDate", "type": "datetime", "default": "now" },
          { "name": "reason", "type": "string" },
          {
            "name": "notes",
            "type": "string",
            "comment": "ENCRYPTED FIELD - Medical notes"
          },
          {
            "name": "diagnoses",
            "type": "string[]",
            "comment": "ENCRYPTED FIELD - List of diagnoses"
          },
          {
            "name": "prescriptions",
            "type": "string",
            "comment": "ENCRYPTED FIELD - Prescribed medications"
          },
          { "name": "followUpDate", "type": "date" },
          { "name": "vitalSigns", "type": "json" }
        ]
      },
      {
        "name": "Document",
        "timestamps": true,
        "fields": [
          { "name": "fileName", "type": "string", "required": true },
          { "name": "mimeType", "type": "string", "required": true },
          { "name": "fileSize", "type": "number", "required": true },
          {
            "name": "s3Path",
            "type": "string",
            "required": true,
            "comment": "S3 file path (files encrypted with KMS at rest)"
          },
          { "name": "checksum", "type": "string" },
          { "name": "version", "type": "number", "default": 1 },
          { "name": "processed", "type": "boolean", "default": false },
          { "name": "thumbnailUrl", "type": "string" },
          {
            "name": "ocrText",
            "type": "string",
            "comment": "ENCRYPTED FIELD - OCR extracted text"
          },
          { "name": "documentType", "type": "string" },
          { "name": "expiryDate", "type": "date" }
        ]
      },
      {
        "name": "User",
        "timestamps": true,
        "fields": [
          {
            "name": "email",
            "type": "string",
            "required": true,
            "unique": true
          },
          { "name": "firstName", "type": "string", "required": true },
          { "name": "lastName", "type": "string", "required": true },
          {
            "name": "role",
            "type": "enum",
            "values": ["admin", "doctor", "nurse", "worker"],
            "default": "worker"
          },
          { "name": "lastLogin", "type": "datetime" },
          { "name": "emailVerified", "type": "boolean", "default": false }
        ]
      }
    ],
    "relationships": [
      {
        "type": "many-to-one",
        "sourceModel": "Visit",
        "targetModel": "Worker",
        "fieldName": "workerId"
      },
      {
        "type": "many-to-one",
        "sourceModel": "Document",
        "targetModel": "Worker",
        "fieldName": "workerId"
      },
      {
        "type": "many-to-one",
        "sourceModel": "Document",
        "targetModel": "User",
        "fieldName": "uploadedBy"
      },
      {
        "type": "many-to-one",
        "sourceModel": "Visit",
        "targetModel": "User",
        "fieldName": "doctorId"
      }
    ]
  },
  "authConfig": {
    "enabled": true,
    "method": "jwt",
    "jwt": {
      "accessTTL": "15m",
      "refreshTTL": "7d",
      "rotation": true,
      "blacklist": true
    },
    "roles": ["admin", "doctor", "nurse", "worker"],
    "emailVerification": true,
    "passwordReset": true
  },
  "featureSelection": {
    "cors": true,
    "helmet": true,
    "compression": true,
    "validation": true,
    "logging": true,
    "caching": true,
    "swagger": true,
    "health": true,
    "rateLimit": true,
    "versioning": false,
    "queues": true,
    "s3Upload": true
  },
  "comments": {
    "encryption": "This config generates a complete encryption system with 3 strategies: DISABLED, LOCAL (free), and AWS_KMS (paid). See ENCRYPTION_STRATEGY_GUIDE.md in generated project.",
    "encryptedFields": "Fields marked with 'ENCRYPTED FIELD' comment should be encrypted using EncryptionService. healthHistory, allergies, currentMedication, socialSecurityNumber, notes, diagnoses, prescriptions, and ocrText will be automatically encrypted.",
    "s3Encryption": "S3 files are automatically encrypted at rest using aws:kms when ENCRYPTION_STRATEGY=aws_kms, or AES256 when ENCRYPTION_STRATEGY=local",
    "setup": {
      "option1_disabled": {
        "description": "No encryption (fastest, not recommended for production)",
        "env": "ENCRYPTION_STRATEGY=disabled"
      },
      "option2_local_free": {
        "description": "FREE encryption using environment variable key",
        "env": [
          "ENCRYPTION_STRATEGY=local",
          "ENCRYPTION_MASTER_KEY=<run: node -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\">"
        ],
        "cost": "FREE",
        "security": "Strong (AES-256-GCM)",
        "bestFor": "Startups, internal tools, < 100K users"
      },
      "option3_aws_kms_paid": {
        "description": "Enterprise-grade encryption with AWS KMS",
        "env": [
          "ENCRYPTION_STRATEGY=aws_kms",
          "KMS_KEY_ID=arn:aws:kms:us-east-1:123456789012:key/abcd-1234",
          "AWS_REGION=us-east-1",
          "AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE",
          "AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
        ],
        "cost": "~$7/month for 1M records",
        "security": "Bank-grade (HSM, automatic rotation, audit logs)",
        "compliance": "HIPAA, GDPR, PCI DSS",
        "bestFor": "Medical data, financial data, enterprise"
      }
    },
    "features": {
      "encryption": "✅ Field-level encryption (3 strategies: DISABLED, LOCAL, AWS_KMS)",
      "s3": "✅ S3 file uploads with lifecycle management and KMS encryption",
      "queues": "✅ BullMQ background jobs (5 queue types: notification, document, sync, analytics, cleanup)",
      "email": "✅ Email service (verification, password reset, welcome, notifications)",
      "auth": "✅ JWT authentication with refresh tokens and email verification",
      "security": "✅ Helmet, CORS, rate limiting, CSRF, input sanitization",
      "monitoring": "✅ Health checks, structured logging (Pino), Swagger docs",
      "database": "✅ MongoDB with Mongoose, connection pooling, indexes"
    }
  }
}
