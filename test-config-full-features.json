{
  "projectSetup": {
    "projectName": "medical-hub",
    "description": "Complete medical records management system with FLAC, RBAC, OAuth, and all production features",
    "author": "Healthcare Team",
    "license": "MIT",
    "nodeVersion": "20",
    "packageManager": "npm"
  },
  "databaseConfig": {
    "databaseType": "MongoDB",
    "provider": "Atlas",
    "connectionString": "mongodb://localhost:27017/medicalhub",
    "autoMigration": "push"
  },
  "authConfig": {
    "enabled": true,
    "method": "jwt",
    "jwt": {
      "accessTTL": "15m",
      "refreshTTL": "7d",
      "rotation": true,
      "blacklist": true
    },
    "roles": ["Patient", "Doctor", "Nurse", "Admin", "Receptionist"],
    "oauth": {
      "enabled": true,
      "providers": [
        {
          "name": "google",
          "clientId": "${GOOGLE_CLIENT_ID}",
          "clientSecret": "${GOOGLE_CLIENT_SECRET}",
          "callbackURL": "http://localhost:3000/auth/google/callback"
        },
        {
          "name": "github",
          "clientId": "${GITHUB_CLIENT_ID}",
          "clientSecret": "${GITHUB_CLIENT_SECRET}",
          "callbackURL": "http://localhost:3000/auth/github/callback"
        }
      ]
    }
  },
  "featureSelection": {
    "cors": true,
    "helmet": true,
    "compression": true,
    "validation": true,
    "logging": true,
    "caching": true,
    "swagger": true,
    "health": true,
    "rateLimit": true,
    "versioning": true,
    "fieldLevelAccessControl": true
  },
  "modelDefinition": {
    "models": [
      {
        "name": "Patient",
        "timestamps": true,
        "fields": [
          {
            "name": "email",
            "type": "string",
            "required": true,
            "unique": true
          },
          {
            "name": "firstName",
            "type": "string",
            "required": true,
            "minLength": 2,
            "maxLength": 50
          },
          {
            "name": "lastName",
            "type": "string",
            "required": true,
            "minLength": 2,
            "maxLength": 50
          },
          {
            "name": "dateOfBirth",
            "type": "date",
            "required": true
          },
          {
            "name": "phone",
            "type": "string",
            "required": true,
            "pattern": "^\\+?[1-9]\\d{1,14}$"
          },
          {
            "name": "address",
            "type": "string",
            "required": false,
            "maxLength": 500
          },
          {
            "name": "ssn",
            "type": "string",
            "required": true,
            "unique": true,
            "pattern": "^\\d{3}-\\d{2}-\\d{4}$"
          },
          {
            "name": "insuranceNumber",
            "type": "string",
            "required": false
          },
          {
            "name": "emergencyContact",
            "type": "json",
            "required": false
          },
          {
            "name": "medicalHistory",
            "type": "string",
            "required": false,
            "maxLength": 5000
          },
          {
            "name": "allergies",
            "type": "string[]",
            "required": false
          },
          {
            "name": "bloodType",
            "type": "enum",
            "values": ["A+", "A-", "B+", "B-", "AB+", "AB-", "O+", "O-"],
            "required": false
          },
          {
            "name": "isActive",
            "type": "boolean",
            "default": true
          }
        ],
        "accessControl": {
          "Patient": {
            "allowSelfOnly": true,
            "allow": ["*"],
            "deny": ["ssn", "insuranceNumber", "medicalHistory"],
            "allowRead": true,
            "allowWrite": false,
            "allowDelete": false
          },
          "Doctor": {
            "allow": ["*"],
            "deny": ["ssn"],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": false
          },
          "Nurse": {
            "allow": [
              "firstName",
              "lastName",
              "dateOfBirth",
              "phone",
              "allergies",
              "bloodType"
            ],
            "deny": ["ssn", "insuranceNumber", "medicalHistory"],
            "allowRead": true,
            "allowWrite": false,
            "allowDelete": false
          },
          "Admin": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": true
          }
        }
      },
      {
        "name": "Doctor",
        "timestamps": true,
        "fields": [
          {
            "name": "email",
            "type": "string",
            "required": true,
            "unique": true
          },
          {
            "name": "firstName",
            "type": "string",
            "required": true
          },
          {
            "name": "lastName",
            "type": "string",
            "required": true
          },
          {
            "name": "phone",
            "type": "string",
            "required": true
          },
          {
            "name": "specialization",
            "type": "enum",
            "values": [
              "Cardiology",
              "Neurology",
              "Pediatrics",
              "Oncology",
              "Orthopedics",
              "Dermatology",
              "General Practice"
            ],
            "required": true
          },
          {
            "name": "licenseNumber",
            "type": "string",
            "required": true,
            "unique": true
          },
          {
            "name": "yearsOfExperience",
            "type": "number",
            "required": true,
            "min": 0,
            "max": 60
          },
          {
            "name": "salary",
            "type": "number",
            "required": true,
            "min": 0
          },
          {
            "name": "workSchedule",
            "type": "json",
            "required": false
          },
          {
            "name": "isActive",
            "type": "boolean",
            "default": true
          }
        ],
        "accessControl": {
          "Doctor": {
            "allowSelfOnly": true,
            "allow": ["*"],
            "deny": ["salary"],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": false
          },
          "Admin": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": true
          },
          "Patient": {
            "allow": [
              "firstName",
              "lastName",
              "specialization",
              "yearsOfExperience"
            ],
            "deny": [
              "email",
              "phone",
              "licenseNumber",
              "salary",
              "workSchedule"
            ],
            "allowRead": true,
            "allowWrite": false,
            "allowDelete": false
          }
        }
      },
      {
        "name": "Appointment",
        "timestamps": true,
        "fields": [
          {
            "name": "appointmentDate",
            "type": "datetime",
            "required": true
          },
          {
            "name": "duration",
            "type": "number",
            "required": true,
            "min": 15,
            "max": 240
          },
          {
            "name": "reason",
            "type": "string",
            "required": true,
            "maxLength": 500
          },
          {
            "name": "status",
            "type": "enum",
            "values": [
              "Scheduled",
              "Confirmed",
              "In Progress",
              "Completed",
              "Cancelled",
              "No Show"
            ],
            "required": true,
            "default": "Scheduled"
          },
          {
            "name": "notes",
            "type": "string",
            "required": false,
            "maxLength": 2000
          },
          {
            "name": "diagnosis",
            "type": "string",
            "required": false,
            "maxLength": 5000
          },
          {
            "name": "prescription",
            "type": "json",
            "required": false
          },
          {
            "name": "fee",
            "type": "number",
            "required": true,
            "min": 0
          },
          {
            "name": "isPaid",
            "type": "boolean",
            "default": false
          }
        ],
        "accessControl": {
          "Patient": {
            "allowSelfOnly": true,
            "allow": [
              "appointmentDate",
              "duration",
              "reason",
              "status",
              "fee",
              "isPaid"
            ],
            "deny": ["notes", "diagnosis", "prescription"],
            "allowRead": true,
            "allowWrite": false,
            "allowDelete": false
          },
          "Doctor": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": false
          },
          "Receptionist": {
            "allow": [
              "appointmentDate",
              "duration",
              "reason",
              "status",
              "fee",
              "isPaid"
            ],
            "deny": ["notes", "diagnosis", "prescription"],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": false
          },
          "Admin": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": true
          }
        }
      },
      {
        "name": "MedicalRecord",
        "timestamps": true,
        "fields": [
          {
            "name": "recordDate",
            "type": "datetime",
            "required": true,
            "default": "now"
          },
          {
            "name": "recordType",
            "type": "enum",
            "values": [
              "Consultation",
              "Lab Result",
              "Imaging",
              "Surgery",
              "Vaccination",
              "Prescription"
            ],
            "required": true
          },
          {
            "name": "title",
            "type": "string",
            "required": true,
            "maxLength": 200
          },
          {
            "name": "description",
            "type": "string",
            "required": true,
            "maxLength": 5000
          },
          {
            "name": "attachments",
            "type": "json[]",
            "required": false
          },
          {
            "name": "isConfidential",
            "type": "boolean",
            "default": false
          },
          {
            "name": "vitalSigns",
            "type": "json",
            "required": false
          }
        ],
        "accessControl": {
          "Patient": {
            "allowSelfOnly": true,
            "allow": [
              "recordDate",
              "recordType",
              "title",
              "description",
              "vitalSigns"
            ],
            "deny": ["attachments"],
            "allowRead": true,
            "allowWrite": false,
            "allowDelete": false
          },
          "Doctor": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": false
          },
          "Nurse": {
            "allow": [
              "recordDate",
              "recordType",
              "title",
              "description",
              "vitalSigns"
            ],
            "deny": ["attachments"],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": false
          },
          "Admin": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": true
          }
        }
      },
      {
        "name": "Prescription",
        "timestamps": true,
        "fields": [
          {
            "name": "prescriptionDate",
            "type": "datetime",
            "required": true,
            "default": "now"
          },
          {
            "name": "medications",
            "type": "json[]",
            "required": true
          },
          {
            "name": "instructions",
            "type": "string",
            "required": true,
            "maxLength": 2000
          },
          {
            "name": "duration",
            "type": "string",
            "required": true
          },
          {
            "name": "refillsAllowed",
            "type": "number",
            "required": true,
            "min": 0,
            "max": 12
          },
          {
            "name": "isFilled",
            "type": "boolean",
            "default": false
          },
          {
            "name": "pharmacyNotes",
            "type": "string",
            "required": false,
            "maxLength": 1000
          }
        ],
        "accessControl": {
          "Patient": {
            "allowSelfOnly": true,
            "allow": ["*"],
            "deny": ["pharmacyNotes"],
            "allowRead": true,
            "allowWrite": false,
            "allowDelete": false
          },
          "Doctor": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": false
          },
          "Admin": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": true
          }
        }
      },
      {
        "name": "Department",
        "timestamps": true,
        "fields": [
          {
            "name": "name",
            "type": "string",
            "required": true,
            "unique": true
          },
          {
            "name": "description",
            "type": "string",
            "required": false,
            "maxLength": 1000
          },
          {
            "name": "location",
            "type": "string",
            "required": true
          },
          {
            "name": "phone",
            "type": "string",
            "required": true
          },
          {
            "name": "budget",
            "type": "number",
            "required": true,
            "min": 0
          },
          {
            "name": "isActive",
            "type": "boolean",
            "default": true
          }
        ],
        "accessControl": {
          "Admin": {
            "allow": ["*"],
            "deny": [],
            "allowRead": true,
            "allowWrite": true,
            "allowDelete": true
          },
          "Doctor": {
            "allow": ["name", "description", "location", "phone"],
            "deny": ["budget"],
            "allowRead": true,
            "allowWrite": false,
            "allowDelete": false
          }
        }
      }
    ],
    "relationships": [
      {
        "id": "rel-1",
        "type": "one-to-many",
        "fromModel": "Patient",
        "targetModel": "Appointment",
        "fieldName": "appointments"
      },
      {
        "id": "rel-2",
        "type": "one-to-many",
        "fromModel": "Doctor",
        "targetModel": "Appointment",
        "fieldName": "appointments"
      },
      {
        "id": "rel-3",
        "type": "one-to-many",
        "fromModel": "Patient",
        "targetModel": "MedicalRecord",
        "fieldName": "medicalRecords"
      },
      {
        "id": "rel-4",
        "type": "one-to-many",
        "fromModel": "Doctor",
        "targetModel": "MedicalRecord",
        "fieldName": "createdRecords"
      },
      {
        "id": "rel-5",
        "type": "one-to-many",
        "fromModel": "Appointment",
        "targetModel": "Prescription",
        "fieldName": "prescriptions"
      },
      {
        "id": "rel-6",
        "type": "one-to-many",
        "fromModel": "Patient",
        "targetModel": "Prescription",
        "fieldName": "prescriptions"
      },
      {
        "id": "rel-7",
        "type": "one-to-many",
        "fromModel": "Doctor",
        "targetModel": "Prescription",
        "fieldName": "prescriptions"
      },
      {
        "id": "rel-8",
        "type": "many-to-one",
        "fromModel": "Doctor",
        "targetModel": "Department",
        "fieldName": "department"
      }
    ],
    "testScenarios": [
      {
        "name": "Patient Self-Access",
        "description": "Patient can view their own data but not SSN or medical history",
        "role": "Patient",
        "entity": "Patient",
        "isSelf": true,
        "expectedVisible": [
          "email",
          "firstName",
          "lastName",
          "dateOfBirth",
          "phone",
          "address",
          "bloodType"
        ],
        "expectedHidden": ["ssn", "insuranceNumber", "medicalHistory"]
      },
      {
        "name": "Doctor Access to Patient",
        "description": "Doctor can see most patient data except SSN",
        "role": "Doctor",
        "entity": "Patient",
        "isSelf": false,
        "expectedVisible": [
          "email",
          "firstName",
          "lastName",
          "dateOfBirth",
          "phone",
          "medicalHistory",
          "allergies"
        ],
        "expectedHidden": ["ssn"]
      },
      {
        "name": "Nurse Limited Access",
        "description": "Nurse has limited read-only access to patient data",
        "role": "Nurse",
        "entity": "Patient",
        "isSelf": false,
        "expectedVisible": [
          "firstName",
          "lastName",
          "dateOfBirth",
          "phone",
          "allergies",
          "bloodType"
        ],
        "expectedHidden": ["ssn", "insuranceNumber", "medicalHistory"]
      },
      {
        "name": "Admin Full Access",
        "description": "Admin can see everything",
        "role": "Admin",
        "entity": "Patient",
        "isSelf": false,
        "expectedVisible": ["*"],
        "expectedHidden": []
      },
      {
        "name": "Doctor Self-Access Salary Hidden",
        "description": "Doctor viewing their own profile cannot see salary",
        "role": "Doctor",
        "entity": "Doctor",
        "isSelf": true,
        "expectedVisible": [
          "email",
          "firstName",
          "lastName",
          "specialization",
          "licenseNumber"
        ],
        "expectedHidden": ["salary"]
      },
      {
        "name": "Patient View Doctor Info",
        "description": "Patient can see basic doctor info only",
        "role": "Patient",
        "entity": "Doctor",
        "isSelf": false,
        "expectedVisible": [
          "firstName",
          "lastName",
          "specialization",
          "yearsOfExperience"
        ],
        "expectedHidden": [
          "email",
          "phone",
          "licenseNumber",
          "salary",
          "workSchedule"
        ]
      },
      {
        "name": "Receptionist Appointment Access",
        "description": "Receptionist can manage appointments but not see medical details",
        "role": "Receptionist",
        "entity": "Appointment",
        "isSelf": false,
        "expectedVisible": [
          "appointmentDate",
          "duration",
          "reason",
          "status",
          "fee",
          "isPaid"
        ],
        "expectedHidden": ["notes", "diagnosis", "prescription"]
      },
      {
        "name": "Patient Prescription Access",
        "description": "Patient can view their prescriptions but not pharmacy notes",
        "role": "Patient",
        "entity": "Prescription",
        "isSelf": true,
        "expectedVisible": [
          "prescriptionDate",
          "medications",
          "instructions",
          "duration",
          "refillsAllowed",
          "isFilled"
        ],
        "expectedHidden": ["pharmacyNotes"]
      }
    ]
  }
}
